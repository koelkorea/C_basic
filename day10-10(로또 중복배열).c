#include <stdio.h>
#include <stdlib.h>				//	srand(), rand() 함수 사용 가능하게 함

// 로또 번호 6개를 n개 생성하는 기능 함수를 써서 구현
//		-> 생성할 개수 저장
//		-> 1번째 로또 번호 6개 생성 + 중복검사
//		-> 생성된 녀석을 정렬 (순차, 선택)
//		-> 번호 출력

// (전체)로또 buy_num개만큼 발권 (lotto_generate, lotto_sort 가 내부에 포함 후 반복)
void lotto_repeat(int buy_num);

// (1인분) 로또 뽑는 로직(lotto_generate, lotto_duplication_check, lotto_sort 포함)
void lotto_one_cycle(void);

//	(최하위 로직 3개)
int lotto_generate(void);				// 1) 개별 로또 번호 발급
int lotto_duplication_check(int check_num, int duplication_check[46]);		// 2) 1싸이클 뽑는 중 중복체크
void lotto_sort(int array[6]);		// 3) 뽑은거 정렬

int main() {
	srand((unsigned int)time(NULL));

	int buy_num = 0;

	printf_s("로또를 몇 장 사시겠습니까? : ");
	scanf_s("%d", &buy_num);
	
	// 정해진 갯수 만큼 로또 돌리기 (lotto_generate, lotto_sort 가 내부에 포함 후 반복)
	lotto_repeat(buy_num);

	return 0;
}

// 1. 개별 로또 번호 발급
int lotto_generate(void) {

	int lotto_result = rand() % 45 + 1;

	return lotto_result;
}

// 2. 1싸이클 뽑는 중 중복체크
int lotto_duplication_check(int check_num, int duplication_check[46]) {

	if (duplication_check[check_num] == 1) {

		printf("중복감지(%d) ", check_num);
		return 0;

	}
	else if (duplication_check[check_num] == 0) {

		duplication_check[check_num] = 1;
		return 1;
	}

}

// 3. 개별 로또 번호 발급
void lotto_sort(int array[]) {

	int temp;

	for (int i = 0; i < 6 ; i++) {

		for (int j = i + 1; j < 6 ; j++) {

			if (array[j] < array[i]) {
				temp = array[i];
				array[i] = array[j];
				array[j] = temp;
			}
		}
	}
}


// (1인분) 로또 뽑는 로직(lotto_generate, lotto_duplication_check, lotto_sort 포함)
void lotto_one_cycle(void) {

	int duplication_check[46] = { 0 };
	int lotto_array[6] = { 0 };

	for (int i = 0; i < sizeof(lotto_array) / sizeof(lotto_array[0]) ; i++) {

		int duplication_status = 1;

		do {
			lotto_array[i] = lotto_generate();		// 1. 개별 뽑기
			duplication_status = lotto_duplication_check(lotto_array[i], duplication_check);		// 2. 뽑은 녀석 중복여부 체크 (0이면 중복임)

		} while (duplication_status == 0);

	}

	lotto_sort(lotto_array);		// 3. 뽑은거 정렬

	// 1, 2, 3 과정 완료 후.. 해당 회차 로또 뽑은 내역 출력 
	for (int i = 0; i < sizeof(lotto_array) / sizeof(lotto_array[0]) ; i++) {
		printf("%d ", lotto_array[i]);
	}

	printf("\n");
}

// (전체)로또 buy_num개만큼 발권 (lotto_generate, lotto_sort 가 내부에 포함 후 반복)
void lotto_repeat(int buy_num) {

	for (int j = 1; j <= buy_num; j++) {

		printf("%d 번째 로또 번호 : ", j);
		lotto_one_cycle();
	}
}